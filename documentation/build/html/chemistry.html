

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chemistry &mdash; pyOpenMS 2.5.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Peptides and Proteins" href="aasequences.html" />
    <link rel="prev" title="MS Data" href="datastructures.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyOpenMS
          

          
          </a>

          
            
            
              <div class="version">
                2.5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">pyOpenMS Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_handling.html">Reading Raw MS data</a></li>
<li class="toctree-l1"><a class="reference internal" href="mzMLFileFormat.html">mzML files</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_file_handling.html">Other MS data formats</a></li>
</ul>
<p class="caption"><span class="caption-text">Mass Spectrometry Concepts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="datastructures.html">MS Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Chemistry</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#constants">Constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elements">Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#isotopes">Isotopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mass-defect">Mass Defect</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#molecular-formulae">Molecular Formulae</a></li>
<li class="toctree-l2"><a class="reference internal" href="#isotopic-distributions">Isotopic Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#amino-acids">Amino Acids</a></li>
<li class="toctree-l2"><a class="reference internal" href="#amino-acid-modifications">Amino Acid Modifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ribonucleotides">Ribonucleotides</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aasequences.html">Peptides and Proteins</a></li>
<li class="toctree-l1"><a class="reference internal" href="nasequences.html">Oligonucleotides: RNA</a></li>
<li class="toctree-l1"><a class="reference internal" href="theoreticalspectrumgenerator.html">TheoreticalSpectrumGenerator</a></li>
<li class="toctree-l1"><a class="reference internal" href="digestion.html">Digestion</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastructures_id.html">Identification Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastructures_quant.html">Quantitative Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Simple Data Manipulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_manipulation.html">Simple Data Manipulation</a></li>
</ul>
<p class="caption"><span class="caption-text">OpenMS Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parameter_handling.html">Parameter Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="smoothing.html">Smoothing</a></li>
<li class="toctree-l1"><a class="reference internal" href="mass_decomposition.html">Mass Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="deisotoping.html">Charge and Isotope Deconvolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_detection.html">Feature Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="peptide_search.html">Peptide Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromatographic_analysis.html">Chromagraphic Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">R language</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyopenms_in_r.html">pyOpenMS in R</a></li>
</ul>
<p class="caption"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_from_source.html">Build from source</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrap_classes.html">Wrapping Workflow and wrapping new Classes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyOpenMS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Chemistry</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/chemistry.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chemistry">
<h1>Chemistry<a class="headerlink" href="#chemistry" title="Permalink to this headline">¶</a></h1>
<p>OpenMS has representations for various chemical concepts including molecular
formulas, isotopes, ribonucleotide and amino acid sequences as well as common
modifications of amino acids or ribonucleotides.</p>
<div class="section" id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Permalink to this headline">¶</a></h2>
<p>OpenMS has many chemical and physical constants built in:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyopenms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">pyopenms</span><span class="o">.</span><span class="n">Constants</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Avogadro&#39;s number is&quot;</span><span class="p">,</span> <span class="n">pyopenms</span><span class="o">.</span><span class="n">Constants</span><span class="o">.</span><span class="n">AVOGADRO</span><span class="p">)</span>
</pre></div>
</div>
<p>which provides access to constants such as Avogadro’s number or the electron
mass.</p>
</div>
<div class="section" id="elements">
<h2>Elements<a class="headerlink" href="#elements" title="Permalink to this headline">¶</a></h2>
<p>In OpenMS, elements are stored in <code class="docutils literal notranslate"><span class="pre">ElementDB</span></code> which has entries for dozens of
elements commonly used in mass spectrometry. The database is stored in the
<code class="docutils literal notranslate"><span class="pre">pyopenms/share/OpenMS/CHEMISTRY/Elements.xml</span></code> file (where a user can
add new elements if necessary).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">edb</span> <span class="o">=</span> <span class="n">ElementDB</span><span class="p">()</span>

<span class="n">edb</span><span class="o">.</span><span class="n">hasElement</span><span class="p">(</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
<span class="n">edb</span><span class="o">.</span><span class="n">hasElement</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>

<span class="n">oxygen</span> <span class="o">=</span> <span class="n">edb</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">oxygen</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">oxygen</span><span class="o">.</span><span class="n">getSymbol</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">oxygen</span><span class="o">.</span><span class="n">getMonoWeight</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">oxygen</span><span class="o">.</span><span class="n">getAverageWeight</span><span class="p">())</span>

<span class="n">sulfur</span> <span class="o">=</span> <span class="n">edb</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sulfur</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">sulfur</span><span class="o">.</span><span class="n">getSymbol</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">sulfur</span><span class="o">.</span><span class="n">getMonoWeight</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">sulfur</span><span class="o">.</span><span class="n">getAverageWeight</span><span class="p">())</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">sulfur</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">()</span>

<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;One mole of oxygen weighs&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">oxygen</span><span class="o">.</span><span class="n">getAverageWeight</span><span class="p">(),</span> <span class="s2">&quot;grams&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;One mole of 16O2 weighs&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">oxygen</span><span class="o">.</span><span class="n">getMonoWeight</span><span class="p">(),</span> <span class="s2">&quot;grams&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As we can see, the OpenMS <code class="docutils literal notranslate"><span class="pre">ElementDB</span></code> has entries for common elements like
Oxygen and Sulfur as well as information on their average and monoisotopic
weight. Note that the monoisotopic weight is the weight of the most abundant
isotope while the average weight is the sum across all isotopes, weighted by
their natural abundance. Therefore, one mole of oxygen (O2) weighs slightly
more than a mole of only its monoisotopic isotope since natural oxygen is a
mixture of multiple isotopes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Oxygen</span>
<span class="n">O</span>
<span class="mf">15.994915</span>
<span class="mf">15.999405323160001</span>
<span class="n">Sulfur</span>
<span class="n">S</span>
<span class="mf">31.97207073</span>
<span class="mf">32.066084735289</span>
<span class="n">One</span> <span class="n">mole</span> <span class="n">of</span> <span class="n">oxygen</span> <span class="n">weighs</span> <span class="mf">31.998810646320003</span> <span class="n">grams</span>
<span class="n">One</span> <span class="n">mole</span> <span class="n">of</span> <span class="mi">16</span><span class="n">O2</span> <span class="n">weighs</span> <span class="mf">31.98983</span> <span class="n">grams</span>
</pre></div>
</div>
<div class="section" id="isotopes">
<h3>Isotopes<a class="headerlink" href="#isotopes" title="Permalink to this headline">¶</a></h3>
<p>We can also inspect the full isotopic distribution of oxygen and sulfur:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">edb</span> <span class="o">=</span> <span class="n">ElementDB</span><span class="p">()</span>

<span class="n">oxygen</span> <span class="o">=</span> <span class="n">edb</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">oxygen</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">()</span>
<span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">():</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Oxygen isotope&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getMZ</span><span class="p">(),</span> <span class="s2">&quot;has abundance&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>

<span class="n">sulfur</span> <span class="o">=</span> <span class="n">edb</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">sulfur</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">()</span>
<span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">():</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Sulfur isotope&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getMZ</span><span class="p">(),</span> <span class="s2">&quot;has abundance&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>OpenMS can compute isotopic distributions for individual elements which contain
information for all stable elements.  The current values in the file are
average abundances found in nature, which may differ depending on location. The
above code outputs the isotopes of oxygen and sulfur as well as their
abundance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Oxygen</span> <span class="n">isotope</span> <span class="mf">15.994915</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">99.75699782371521</span> <span class="o">%</span>
<span class="n">Oxygen</span> <span class="n">isotope</span> <span class="mf">16.999132</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.03800000122282654</span> <span class="o">%</span>
<span class="n">Oxygen</span> <span class="n">isotope</span> <span class="mf">17.999169</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.20500000100582838</span> <span class="o">%</span>

<span class="n">Sulfur</span> <span class="n">isotope</span> <span class="mf">31.97207073</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">94.92999911308289</span> <span class="o">%</span>
<span class="n">Sulfur</span> <span class="n">isotope</span> <span class="mf">32.971458</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.7600000128149986</span> <span class="o">%</span>
<span class="n">Sulfur</span> <span class="n">isotope</span> <span class="mf">33.967867</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">4.2899999767541885</span> <span class="o">%</span>
<span class="n">Sulfur</span> <span class="n">isotope</span> <span class="mf">35.967081</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.019999999494757503</span> <span class="o">%</span>
</pre></div>
</div>
</div>
<div class="section" id="mass-defect">
<h3>Mass Defect<a class="headerlink" href="#mass-defect" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>While all isotopes are created by adding one or more neutrons to the
nucleus, this leads to different observed masses due to the <a class="reference external" href="https://en.wikipedia.org/wiki/Nuclear_binding_energy#Mass_defect">mass defect</a>, which
describes the difference between the mass of an atom and the mass of
its constituent particles. For example, the mass difference between 12C and
13C is slightly different than the mass difference between 14N and 15N, even
though both only differ by a neutron from their monoisotopic element:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">edb</span> <span class="o">=</span> <span class="n">ElementDB</span><span class="p">()</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">edb</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">()</span><span class="o">.</span><span class="n">getContainer</span><span class="p">()</span>
<span class="n">carbon_isotope_difference</span> <span class="o">=</span> <span class="n">isotopes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getMZ</span><span class="p">()</span> <span class="o">-</span> <span class="n">isotopes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getMZ</span><span class="p">()</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">edb</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">()</span><span class="o">.</span><span class="n">getContainer</span><span class="p">()</span>
<span class="n">nitrogen_isotope_difference</span> <span class="o">=</span> <span class="n">isotopes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getMZ</span><span class="p">()</span> <span class="o">-</span> <span class="n">isotopes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getMZ</span><span class="p">()</span>

<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Mass difference between 12C and 13C:&quot;</span><span class="p">,</span> <span class="n">carbon_isotope_difference</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Mass difference between 14N and N15:&quot;</span><span class="p">,</span> <span class="n">nitrogen_isotope_difference</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Relative deviation:&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">carbon_isotope_difference</span> <span class="o">-</span>
        <span class="n">nitrogen_isotope_difference</span><span class="p">)</span><span class="o">/</span><span class="n">carbon_isotope_difference</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Mass</span> <span class="n">difference</span> <span class="n">between</span> <span class="mi">12</span><span class="n">C</span> <span class="ow">and</span> <span class="mi">13</span><span class="n">C</span><span class="p">:</span> <span class="mf">1.003355</span>
<span class="n">Mass</span> <span class="n">difference</span> <span class="n">between</span> <span class="mi">14</span><span class="n">N</span> <span class="ow">and</span> <span class="mi">15</span><span class="n">N</span><span class="p">:</span> <span class="mf">0.997035</span>
<span class="n">Relative</span> <span class="n">deviation</span><span class="p">:</span> <span class="mf">0.6298867300208343</span> <span class="o">%</span>
</pre></div>
</div>
<p>This difference can actually be measured by a high resolution mass
spectrometric instrument and is used in the <a class="reference external" href="https://en.wikipedia.org/wiki/Tandem_mass_tag">tandem mass tag (TMT)</a> labelling strategy.</p>
<p>For the same reason, the helium atom has a slightly lower mass than the mass
of its constituent particles (two protons, two neutrons and two electrons):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyopenms.Constants</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">helium</span> <span class="o">=</span> <span class="n">ElementDB</span><span class="p">()</span><span class="o">.</span><span class="n">getElement</span><span class="p">(</span><span class="s2">&quot;He&quot;</span><span class="p">)</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">helium</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">()</span>

<span class="n">mass_sum</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">PROTON_MASS_U</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ELECTRON_MASS_U</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">NEUTRON_MASS_U</span>
<span class="n">helium4</span> <span class="o">=</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getMZ</span><span class="p">()</span>
<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Sum of masses of 2 protons, neutrons and electrons:&quot;</span><span class="p">,</span> <span class="n">mass_sum</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Mass of He4:&quot;</span><span class="p">,</span> <span class="n">helium4</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Difference between the two masses:&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">mass_sum</span> <span class="o">-</span> <span class="n">helium4</span><span class="p">)</span><span class="o">/</span><span class="n">mass_sum</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Sum</span> <span class="n">of</span> <span class="n">masses</span> <span class="n">of</span> <span class="mi">2</span> <span class="n">protons</span><span class="p">,</span> <span class="n">neutrons</span> <span class="ow">and</span> <span class="n">electrons</span><span class="p">:</span> <span class="mf">4.032979924670597</span>
<span class="n">Mass</span> <span class="n">of</span> <span class="n">He4</span><span class="p">:</span> <span class="mf">4.00260325415</span>
<span class="n">Difference</span> <span class="n">between</span> <span class="n">the</span> <span class="n">two</span> <span class="n">masses</span><span class="p">:</span> <span class="mf">0.7532065888743016</span> <span class="o">%</span>
</pre></div>
</div>
<p class="last">The difference in mass is the energy released when the atom was formed (or
in other words, it is the energy required to dissassemble the nucleus into
its particles).</p>
</div>
</div>
</div>
<div class="section" id="molecular-formulae">
<h2>Molecular Formulae<a class="headerlink" href="#molecular-formulae" title="Permalink to this headline">¶</a></h2>
<p>Elements can be combined to molecular formulas (<code class="docutils literal notranslate"><span class="pre">EmpiricalFormula</span></code>) which can
be used to describe molecules such as metabolites, amino acid sequences or
oligonucleotides.  The class supports a large number of operations like
addition and subtraction. A simple example is given in the next few lines of
code.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">methanol</span> <span class="o">=</span> <span class="n">EmpiricalFormula</span><span class="p">(</span><span class="s2">&quot;CH3OH&quot;</span><span class="p">)</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">EmpiricalFormula</span><span class="p">(</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span>
<span class="n">ethanol</span> <span class="o">=</span> <span class="n">EmpiricalFormula</span><span class="p">(</span><span class="s2">&quot;CH2&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">methanol</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Ethanol chemical formula:&quot;</span><span class="p">,</span> <span class="n">ethanol</span><span class="o">.</span><span class="n">toString</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Ethanol composition:&quot;</span><span class="p">,</span> <span class="n">ethanol</span><span class="o">.</span><span class="n">getElementalComposition</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Ethanol has&quot;</span><span class="p">,</span> <span class="n">ethanol</span><span class="o">.</span><span class="n">getElementalComposition</span><span class="p">()[</span><span class="sa">b</span><span class="s2">&quot;H&quot;</span><span class="p">],</span> <span class="s2">&quot;hydrogen atoms&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>which produces</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Ethanol</span> <span class="n">chemical</span> <span class="n">formula</span><span class="p">:</span> <span class="n">C2H6O1</span>
<span class="n">Ethanol</span> <span class="n">composition</span><span class="p">:</span> <span class="p">{</span><span class="sa">b</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">Ethanol</span> <span class="n">has</span> <span class="mi">6</span> <span class="n">hydrogen</span> <span class="n">atoms</span>
</pre></div>
</div>
<p>Note how in line 5 we were able to make a new molecule by adding existing
molecules (for example by adding two <code class="docutils literal notranslate"><span class="pre">EmpiricalFormula</span></code> objects). In this
case, we illustrated how to make ethanol by adding a <code class="docutils literal notranslate"><span class="pre">CH2</span></code> methyl group to an
existing methanol molecule. Note that OpenMS describes sum formulae with the
<code class="docutils literal notranslate"><span class="pre">EmpiricalFormula</span></code> object and does store structural information in this class.</p>
</div>
<div class="section" id="isotopic-distributions">
<h2>Isotopic Distributions<a class="headerlink" href="#isotopic-distributions" title="Permalink to this headline">¶</a></h2>
<p>OpenMS can also generate theoretical isotopic distributions from analytes
represented as <code class="docutils literal notranslate"><span class="pre">EmpiricalFormula</span></code>. Currently there are two algorithms
implemented, CoarseIsotopePatternGenerator which produces unit mass isotope
patterns and FineIsotopePatternGenerator which is based on the IsoSpec
algorithm <a class="footnote-reference" href="#id4" id="id2">[1]</a> :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">methanol</span> <span class="o">=</span> <span class="n">EmpiricalFormula</span><span class="p">(</span><span class="s2">&quot;CH3OH&quot;</span><span class="p">)</span>
<span class="n">ethanol</span> <span class="o">=</span> <span class="n">EmpiricalFormula</span><span class="p">(</span><span class="s2">&quot;CH2&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">methanol</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Coarse Isotope Distribution:&quot;</span><span class="p">)</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">ethanol</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">(</span> <span class="n">CoarseIsotopePatternGenerator</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="n">prob_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span> <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">()])</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;This covers&quot;</span><span class="p">,</span> <span class="n">prob_sum</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">():</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Isotope&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getMZ</span><span class="p">(),</span> <span class="s2">&quot;has abundance&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Fine Isotope Distribution:&quot;</span><span class="p">)</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">ethanol</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">(</span> <span class="n">FineIsotopePatternGenerator</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)</span> <span class="p">)</span>
<span class="n">prob_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span> <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">()])</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;This covers&quot;</span><span class="p">,</span> <span class="n">prob_sum</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">():</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Isotope&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getMZ</span><span class="p">(),</span> <span class="s2">&quot;has abundance&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>which produces</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Coarse</span> <span class="n">Isotope</span> <span class="n">Distribution</span><span class="p">:</span>
<span class="n">This</span> <span class="n">covers</span> <span class="mf">0.9999999753596569</span> <span class="n">probability</span>
<span class="n">Isotope</span> <span class="mf">46.0418651914</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">97.56630063056946</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">47.045220029199996</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">2.21499539911747</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">48.048574867</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.2142168115824461</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">49.0519297048</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.004488634294830263</span> <span class="o">%</span>

<span class="n">Fine</span> <span class="n">Isotope</span> <span class="n">Distribution</span><span class="p">:</span>
<span class="n">This</span> <span class="n">covers</span> <span class="mf">0.9994461630121805</span> <span class="n">probability</span>
<span class="n">Isotope</span> <span class="mf">46.0418651914</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">97.5662887096405</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">47.0452201914</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">2.110501006245613</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">47.0481419395</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.06732848123647273</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">48.046119191399995</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.20049810409545898</span> <span class="o">%</span>
</pre></div>
</div>
<p>The result calculated with the <code class="docutils literal notranslate"><span class="pre">FineIsotopePatternGenerator</span></code>
contains the hyperfine isotope structure with heavy isotopes of Carbon and
Hydrogen clearly distinguished while the coarse (unit resolution)
isotopic distribution contains summed probabilities for each isotopic peak
without the hyperfine resolution.</p>
<p>Please refer to our previous discussion on the <a class="reference external" href="#mass-defect">mass defect</a> to understand the
results of the hyperfine algorithm and why different elements produce slightly
different masses.
In this example, the hyperfine isotopic distribution will
contain two peaks for the nominal mass of 47: one at <code class="docutils literal notranslate"><span class="pre">47.045</span></code> for the
incorporation of one heavy 13C with a delta mass of <code class="docutils literal notranslate"><span class="pre">1.003355</span></code> and one at <code class="docutils literal notranslate"><span class="pre">47.048</span></code>
for the incorporation of one heavy deuterium with a delta mass of <code class="docutils literal notranslate"><span class="pre">1.006277</span></code>.
These two peaks also have two different abundances (the heavy carbon one has
2.1% abundance and the deuterium one has 0.07% abundance). This can be understood given that
there are 2 carbon atoms and the natural abundance of 13C is about
1.1%, while the molecule has six hydrogen atoms and the natural abundance of
deuterium is about 0.02%. The fine isotopic generator will not generate the
peak at nominal mass 49 since we specified our cutoff at 0.1% total abundance
and the four peaks above cover 99.9% of the
isotopic abundance.</p>
<p>We can also decrease our cutoff and ask for more isotopes to be calculated:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">methanol</span> <span class="o">=</span> <span class="n">EmpiricalFormula</span><span class="p">(</span><span class="s2">&quot;CH3OH&quot;</span><span class="p">)</span>
<span class="n">ethanol</span> <span class="o">=</span> <span class="n">EmpiricalFormula</span><span class="p">(</span><span class="s2">&quot;CH2&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">methanol</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Fine Isotope Distribution:&quot;</span><span class="p">)</span>
<span class="n">isotopes</span> <span class="o">=</span> <span class="n">ethanol</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">(</span> <span class="n">FineIsotopePatternGenerator</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span> <span class="p">)</span>
<span class="n">prob_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span> <span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">()])</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;This covers&quot;</span><span class="p">,</span> <span class="n">prob_sum</span><span class="p">,</span> <span class="s2">&quot;probability&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">():</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Isotope&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getMZ</span><span class="p">(),</span> <span class="s2">&quot;has abundance&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>which produces</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Fine</span> <span class="n">Isotope</span> <span class="n">Distribution</span><span class="p">:</span>
<span class="n">This</span> <span class="n">covers</span> <span class="mf">0.9999993089130612</span> <span class="n">probability</span>
<span class="n">Isotope</span> <span class="mf">46.0418651914</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">97.5662887096405</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">47.0452201914</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">2.110501006245613</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">47.046082191400004</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.03716550418175757</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">47.0481419395</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.06732848123647273</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">48.046119191399995</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.20049810409545898</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">48.0485751914</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.011413302854634821</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">48.0494371914</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.0008039440217544325</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">48.0514969395</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.0014564131561201066</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">49.049474191399995</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.004337066275184043</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">49.0523959395</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.00013835959862262825</span> <span class="o">%</span>
</pre></div>
</div>
<p>Here we can observe more peaks and now also see the heavy oxygen peak at
<code class="docutils literal notranslate"><span class="pre">47.04608</span></code> with a delta mass of <code class="docutils literal notranslate"><span class="pre">1.004217</span></code> (difference between 16O and 17O) at an
abundance of 0.04%, which is what we would expect for a single oxygen atom.
Even though the natural abundance of deuterium (0.02%) is lower than 17O
(0.04%), since there are six hydrogen atoms in the molecule and only one
oxygen, it is more likely that we will see a deuterium peak than a heavy oxygen
peak. Also, even for a small molecule like ethanol, the differences in mass
between the hyperfine peaks can reach more than 110 ppm (48.046 vs 48.051).
Note that the FineIsotopePatternGenerator will generate peaks until the total
error has decreased to 1e-6, allowing us to cover 0.999999 of the probability.</p>
<p>OpenMS can also produce isotopic distribution with masses rounded to the
nearest integer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">isotopes</span> <span class="o">=</span> <span class="n">ethanol</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">(</span> <span class="n">CoarseIsotopePatternGenerator</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="p">)</span>
<span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">():</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Isotope&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getMZ</span><span class="p">(),</span> <span class="s2">&quot;has abundance&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>

<span class="n">Isotope</span> <span class="mf">46.0</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">97.56627082824707</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">47.0</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">2.214994840323925</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">48.0</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.214216741733253</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">49.0</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">0.0044886332034366205</span> <span class="o">%</span>
<span class="n">Isotope</span> <span class="mf">50.0</span> <span class="n">has</span> <span class="n">abundance</span> <span class="mf">2.64924580051229e-05</span> <span class="o">%</span>
</pre></div>
</div>
</div>
<div class="section" id="amino-acids">
<h2>Amino Acids<a class="headerlink" href="#amino-acids" title="Permalink to this headline">¶</a></h2>
<p>An amino acid residue is represented in OpenMS by the class <code class="docutils literal notranslate"><span class="pre">Residue</span></code>. It provides a
container for the amino acids as well as some functionality. The class is able
to provide information such as the isotope distribution of the residue, the
average and monoisotopic weight. The residues can be identified by their full
name, their three letter abbreviation or the single letter abbreviation. The
residue can also be modified, which is implemented in the <code class="docutils literal notranslate"><span class="pre">Modification</span></code> class.
Additional less frequently used parameters of a residue like the gas-phase
basicity and pk values are also available.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lys</span> <span class="o">=</span> <span class="n">ResidueDB</span><span class="p">()</span><span class="o">.</span><span class="n">getResidue</span><span class="p">(</span><span class="s2">&quot;Lysine&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lys</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>
<span class="go">&#39;Lysine&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lys</span><span class="o">.</span><span class="n">getThreeLetterCode</span><span class="p">()</span>
<span class="go">&#39;LYS&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lys</span><span class="o">.</span><span class="n">getOneLetterCode</span><span class="p">()</span>
<span class="go">&#39;K&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lys</span><span class="o">.</span><span class="n">getAverageWeight</span><span class="p">()</span>
<span class="go">146.18788276708443</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lys</span><span class="o">.</span><span class="n">getMonoWeight</span><span class="p">()</span>
<span class="go">146.1055284466</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lys</span><span class="o">.</span><span class="n">getPka</span><span class="p">()</span>
<span class="go">2.16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lys</span><span class="o">.</span><span class="n">getFormula</span><span class="p">()</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span>
<span class="go">u&#39;C6H14N2O2&#39;</span>
</pre></div>
</div>
<p>As we can see, OpenMS knows common amino acids like lysine as well as
some properties of them. These values are stored in <code class="docutils literal notranslate"><span class="pre">Residues.xml</span></code> in the
OpenMS share folder and can, in principle, be modified.</p>
</div>
<div class="section" id="amino-acid-modifications">
<h2>Amino Acid Modifications<a class="headerlink" href="#amino-acid-modifications" title="Permalink to this headline">¶</a></h2>
<p>An amino acid residue modification is represented in OpenMS by the class
<code class="docutils literal notranslate"><span class="pre">ResidueModification</span></code>. The known modifications are stored in the
<code class="docutils literal notranslate"><span class="pre">ModificationsDB</span></code> object, which is capable of retrieving specific
modifications. It contains UniMod as well as PSI modifications.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">ox</span> <span class="o">=</span> <span class="n">ModificationsDB</span><span class="p">()</span><span class="o">.</span><span class="n">getModification</span><span class="p">(</span><span class="s2">&quot;Oxidation&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ox</span><span class="o">.</span><span class="n">getUniModAccession</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ox</span><span class="o">.</span><span class="n">getUniModRecordId</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ox</span><span class="o">.</span><span class="n">getDiffMonoMass</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ox</span><span class="o">.</span><span class="n">getId</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ox</span><span class="o">.</span><span class="n">getFullId</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ox</span><span class="o">.</span><span class="n">getFullName</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ox</span><span class="o">.</span><span class="n">getDiffFormula</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">UniMod</span><span class="p">:</span><span class="mi">35</span>
<span class="mi">35</span>
<span class="mf">15.994915</span>
<span class="n">Oxidation</span>
<span class="n">Oxidation</span> <span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">Oxidation</span> <span class="ow">or</span> <span class="n">Hydroxylation</span>
<span class="n">O1</span>
</pre></div>
</div>
<p>thus providing information about the “Oxidation” modification. As above, we can
investigate the isotopic distribution of the modification (which in this case
is identical to the one of Oxygen by itself):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">isotopes</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">getDiffFormula</span><span class="p">()</span><span class="o">.</span><span class="n">getIsotopeDistribution</span><span class="p">(</span><span class="n">CoarseIsotopePatternGenerator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">iso</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="o">.</span><span class="n">getContainer</span><span class="p">():</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">iso</span><span class="o">.</span><span class="n">getMZ</span><span class="p">(),</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">iso</span><span class="o">.</span><span class="n">getIntensity</span><span class="p">())</span>
</pre></div>
</div>
<p>Which will print the isotopic pattern of the modification (Oxygen):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mf">15.994915</span> <span class="p">:</span> <span class="mf">0.9975699782371521</span>
<span class="mf">16.998269837800002</span> <span class="p">:</span> <span class="mf">0.0003800000122282654</span>
<span class="mf">18.0016246756</span> <span class="p">:</span> <span class="mf">0.002050000010058284</span>
</pre></div>
</div>
</div>
<div class="section" id="ribonucleotides">
<h2>Ribonucleotides<a class="headerlink" href="#ribonucleotides" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Ribonucleotide">ribonucleotide</a> describes
one of the building blocks of DNA and RNA. In OpenMS, a ribonucleotide in its
modified or unmodified form is represented by the <code class="docutils literal notranslate"><span class="pre">Ribonucleotide</span></code> class in
OpenMS.  The class is able to provide information such as the isotope
distribution of the residue, the average and monoisotopic weight. The residues
can be identified by their full name, their three letter abbreviation or the
single letter abbreviation. Modified ribonucleotides are represented by the
same class. Currently, support for RNA is implemented.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uridine</span> <span class="o">=</span> <span class="n">RibonucleotideDB</span><span class="p">()</span><span class="o">.</span><span class="n">getRibonucleotide</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;U&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uridine</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>
<span class="go">&#39;uridine&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uridine</span><span class="o">.</span><span class="n">getCode</span><span class="p">()</span>
<span class="go">&#39;U&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uridine</span><span class="o">.</span><span class="n">getAvgMass</span><span class="p">()</span>
<span class="go">244.2043</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uridine</span><span class="o">.</span><span class="n">getMonoMass</span><span class="p">()</span>
<span class="go">244.0695</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uridine</span><span class="o">.</span><span class="n">getFormula</span><span class="p">()</span><span class="o">.</span><span class="n">toString</span><span class="p">()</span>
<span class="go">&#39;C9H12N2O6&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uridine</span><span class="o">.</span><span class="n">isModified</span><span class="p">()</span>
<span class="go">False</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">methyladenosine</span> <span class="o">=</span> <span class="n">RibonucleotideDB</span><span class="p">()</span><span class="o">.</span><span class="n">getRibonucleotide</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;m1A&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">methyladenosine</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>
<span class="go">&#39;1-methyladenosine&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">methyladenosine</span><span class="o">.</span><span class="n">isModified</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>Łącki MK, Startek M, Valkenborg D, Gambin A.
IsoSpec: Hyperfast Fine Structure Calculator.
Anal Chem. 2017 Mar 21;89(6):3272-3277. <a class="reference external" href="http://doi.org/10.1021/acs.analchem.6b01459">doi: 10.1021/acs.analchem.6b01459.</a></td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aasequences.html" class="btn btn-neutral float-right" title="Peptides and Proteins" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="datastructures.html" class="btn btn-neutral float-left" title="MS Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, OpenMS Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>