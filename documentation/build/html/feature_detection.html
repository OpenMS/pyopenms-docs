

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Feature Detection &mdash; pyOpenMS 2.5.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Peptide Search" href="peptide_search.html" />
    <link rel="prev" title="Charge and Isotope Deconvolution" href="deisotoping.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pyOpenMS
          

          
          </a>

          
            
            
              <div class="version">
                2.5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">pyOpenMS Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">First steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_handling.html">Reading Raw MS data</a></li>
<li class="toctree-l1"><a class="reference internal" href="mzMLFileFormat.html">mzML files</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_file_handling.html">Other MS data formats</a></li>
</ul>
<p class="caption"><span class="caption-text">Mass Spectrometry Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="datastructures.html">MS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemistry.html">Chemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="aasequences.html">Peptides and Proteins</a></li>
<li class="toctree-l1"><a class="reference internal" href="nasequences.html">Oligonucleotides: RNA</a></li>
<li class="toctree-l1"><a class="reference internal" href="theoreticalspectrumgenerator.html">TheoreticalSpectrumGenerator</a></li>
<li class="toctree-l1"><a class="reference internal" href="digestion.html">Digestion</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastructures_id.html">Identification Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="datastructures_quant.html">Quantitative Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Simple Data Manipulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_manipulation.html">Simple Data Manipulation</a></li>
</ul>
<p class="caption"><span class="caption-text">OpenMS Algorithms</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="parameter_handling.html">Parameter Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="smoothing.html">Smoothing</a></li>
<li class="toctree-l1"><a class="reference internal" href="mass_decomposition.html">Mass Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="deisotoping.html">Charge and Isotope Deconvolution</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Feature Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="peptide_search.html">Peptide Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromatographic_analysis.html">Chromagraphic Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">R language</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyopenms_in_r.html">pyOpenMS in R</a></li>
</ul>
<p class="caption"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_from_source.html">Build from source</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrap_classes.html">Wrapping Workflow and wrapping new Classes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyOpenMS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Feature Detection</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/feature_detection.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="feature-detection">
<h1>Feature Detection<a class="headerlink" href="#feature-detection" title="Permalink to this headline">Â¶</a></h1>
<p>One very common task in mass spectrometry is the detection of 2-dimensional
patterns in m/z and time (RT) dimension from a series of MS1 scans. These
patterns are called <code class="docutils literal notranslate"><span class="pre">Features</span></code> and they exhibit a chromatographic elution
profile in the time dimension and an isotopic pattern in the m/z dimension (see
<a class="reference external" href="deisotoping.html">previous section</a> for the 1-dimensional problem).
OpenMS has multiple tools that can identify these features in 2-dimensional
data, these tools are called <cite>FeatureFinder</cite>.  Currently the following
FeatureFinders are available in OpenMS:</p>
<blockquote>
<div><ul class="simple">
<li>FeatureFinderMultiplex</li>
<li>FeatureFinderMRM</li>
<li>FeatureFinderCentroided</li>
<li>FeatureFinderIdentification</li>
<li>FeatureFinderIsotopeWavelet</li>
<li>FeatureFinderMetabo</li>
<li>FeatureFinderSuperHirn</li>
</ul>
</div></blockquote>
<p>All of the algorithms above are for proteomics data with the exception of
FeatureFinderMetabo which works on metabolomics data. One of the most commonly
used FeatureFinders is the FeatureFinderCentroided which works on (high
resolution) centroided data. We can use the following code to find <code class="docutils literal notranslate"><span class="pre">Features</span></code>
in MS data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>
<span class="c1"># from urllib import urlretrieve  # use this code for Python 2.x</span>
<span class="n">gh</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/OpenMS/OpenMS/develop&quot;</span>
<span class="n">urlretrieve</span> <span class="p">(</span><span class="n">gh</span> <span class="o">+</span><span class="s2">&quot;/src/tests/topp/FeatureFinderCentroided_1_input.mzML&quot;</span><span class="p">,</span> <span class="s2">&quot;feature_test.mzML&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pyopenms</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Prepare data loading (save memory by only</span>
<span class="c1"># loading MS1 spectra into memory)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">PeakFileOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">setMSLevels</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">MzMLFile</span><span class="p">()</span>
<span class="n">fh</span><span class="o">.</span><span class="n">setOptions</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

<span class="c1"># Load data</span>
<span class="n">input_map</span> <span class="o">=</span> <span class="n">MSExperiment</span><span class="p">()</span>
<span class="n">fh</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;feature_test.mzML&quot;</span><span class="p">,</span> <span class="n">input_map</span><span class="p">)</span>
<span class="n">input_map</span><span class="o">.</span><span class="n">updateRanges</span><span class="p">()</span>

<span class="n">ff</span> <span class="o">=</span> <span class="n">FeatureFinder</span><span class="p">()</span>
<span class="n">ff</span><span class="o">.</span><span class="n">setLogType</span><span class="p">(</span><span class="n">LogType</span><span class="o">.</span><span class="n">CMD</span><span class="p">)</span>

<span class="c1"># Run the feature finder</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;centroided&quot;</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">FeatureMap</span><span class="p">()</span>
<span class="n">seeds</span> <span class="o">=</span> <span class="n">FeatureMap</span><span class="p">()</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">FeatureFinder</span><span class="p">()</span><span class="o">.</span><span class="n">getParameters</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="n">ff</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">input_map</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">seeds</span><span class="p">)</span>

<span class="n">features</span><span class="o">.</span><span class="n">setUniqueIds</span><span class="p">()</span>
<span class="n">fh</span> <span class="o">=</span> <span class="n">FeatureXMLFile</span><span class="p">()</span>
<span class="n">fh</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="s2">&quot;output.featureXML&quot;</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Found&quot;</span><span class="p">,</span> <span class="n">features</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>With a few lines of Python, we are able to run powerful algorithms available in
OpenMS. The resulting data is held in memory (a <code class="docutils literal notranslate"><span class="pre">FeatureMap</span></code> object) and can be
inspected directly using the <code class="docutils literal notranslate"><span class="pre">help(features)</span></code> comment. It reveals that the
object supports iteration (through the <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> function) as well as direct
access (through the <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> function).  We can also inspect the entry
for <code class="docutils literal notranslate"><span class="pre">FeatureMap</span></code> in the <a class="reference external" href="http://proteomics.ethz.ch/pyOpenMS_Manual.pdf">pyOpenMS manual</a> and learn about the same
functions. This means we write code that uses direct access and iteration in
Python as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f0</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">getRT</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">getMZ</span><span class="p">())</span>
</pre></div>
</div>
<p>Each entry in the <code class="docutils literal notranslate"><span class="pre">FeatureMap</span></code> is a so-called <code class="docutils literal notranslate"><span class="pre">Feature</span></code> and allows direct
access to the <cite>m/z</cite> and <cite>RT</cite> value from Python. Again, we can lear this by
inspecting <code class="docutils literal notranslate"><span class="pre">help(f)</span></code> or by consulting the Manual.</p>
<p>Note: the output file that we have written (<code class="docutils literal notranslate"><span class="pre">output.featureXML</span></code>) is an
OpenMS-internal XML format for storing features. You can learn more about file
formats in the <a class="reference external" href="other_file_handling.html">Reading MS data formats</a> section.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="peptide_search.html" class="btn btn-neutral float-right" title="Peptide Search" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="deisotoping.html" class="btn btn-neutral float-left" title="Charge and Isotope Deconvolution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, OpenMS Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>